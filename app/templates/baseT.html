<!DOCTYPE html>
<html lang="pt-br">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>TESTE - Skoob Clone</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-4Q6Gf2aSP4eDXB8Miphtr37CMZZQ5oXLH2yaXMJ2w8e2ZtHTl7GptT4jmndRuHDT" crossorigin="anonymous" />
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />

    <link rel="stylesheet" href="{{ url_for('static', filename='css/home.css') }}"/>

</head>
<!-- NAV BAR -->

<body>

<nav class="navbar bg-light" style="box-shadow: 0 2px 60px #19875466;">
  <div class="container-fluid">

    <!-- Bot칚o do menu -->
    <button class="btn btn-primary" type="button" data-bs-toggle="offcanvas" data-bs-target="#skOffcanvas">
      <i class="fas fa-bars"></i>
    </button>

    <!-- Logo centralizada -->
    <div class="navbar-center mx-auto">
      <img src="{{ url_for('static', filename='images/skoob-amor-verao.png') }}" width="1" alt="Skoob Logo">
    </div>

    <!-- Nome do usu치rio alinhado  direita -->
    <div class="ms-auto">
      {% if usuario %}
      <a id="nomeuser" class="mb-0 fw-bold" >Ol치, {{ usuario.apelido }}!</a>
      {% endif %}
    </div>

  </div>
</nav>



<!-- ESTRUTURA DO OFFCANVAS -->
  <div class="offcanvas offcanvas-start sk-offcanvas" tabindex="-1" id="skOffcanvas">
    <div class="offcanvas-header">
      <h5 class="offcanvas-title">
       
      </h5>
      <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Fechar"></button>
    </div>
    <div class="offcanvas-body">
      <nav class="nav flex-column">
        <!-- Se칞칚o principal -->
        <a class="nav-link" href="{{ url_for('main.home') }}">
          <i class="fas fa-home"></i>
          <span>In칤cio</span>
        </a>
        <a class="nav-link" href="#">
          <i class="fas fa-user"></i>
          <span>Perfil</span>
        </a>
        <a class="nav-link" href="{{ url_for('livro.minhaestante') }}">
          <i class="fas fa-book"></i>
          <span>Minha Estante</span>
        </a>

        <a class="nav-link"  href="{{ url_for('main.logout') }}">
          <i class="fas fa-door-open"></i>
          <span>Sair</span>
        </a>
        
        <hr class="offcanvas-divider">
        
        <!-- Se칞칚o de categorias -->
        <div class="offcanvas-section-title">
          <i class="fas fa-layer-group me-1"></i>
          Categorias
        </div>
        <a class="nav-link category-link" href="{{ url_for('livro.livraria', _anchor='carouselSuspense') }}">
          <i class="fas fa-mask"></i>
          <span>Suspense</span>
        </a>
        <a class="nav-link category-link" href="{{ url_for('livro.livraria',   _anchor='carouselRomance') }}">
          <i class="fas fa-heart"></i>
          <span>Romance</span>
        </a>
        <a class="nav-link category-link" href="{{ url_for('livro.livraria', _anchor='carouselFantasia') }}">
          <i class="fas fa-dragon"></i>
          <span>Fantasia</span>
        </a>
      </nav>
    </div>
  </div>


  
  <!-- SLIDE 1 -->
  <div class="container mt-5 mb-5">
    <div id="carouselNovidades" class="carousel slide">
      <div class="carousel-indicators">
        <button type="button" data-bs-target="#carouselNovidades" data-bs-slide-to="0" class="active"
          aria-label="Slide 1"></button>
        <button type="button" data-bs-target="#carouselNovidades" data-bs-slide-to="1" aria-label="Slide 2"></button>
        <button type="button" data-bs-target="#carouselNovidades" data-bs-slide-to="2" aria-label="Slide 3"></button>
      </div>
      <div class="carousel-inner">
        <div class="carousel-item" data-livro-id="6">
          <img src="{{ url_for('static', filename='images/slide3.jpg') }}" class="d-block w-100" alt="Imagem">
        </div>
        <div class="carousel-item active" data-livro-id="6">
          <img src="{{ url_for('static', filename='images/slide1.jpg') }}" class="d-block w-100" alt="Imagem">
        </div>
        <div class="carousel-item" data-livro-id="6">
          <img src="{{ url_for('static', filename='images/slide2.jpg') }}" class="d-block w-100" alt="Imagem">
        </div>
      </div>
      <button class="carousel-control-prev" type="button" data-bs-target="#carouselNovidades" data-bs-slide="prev">
        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
        <span class="visually-hidden">Previous</span>
      </button>
      <button class="carousel-control-next" type="button" data-bs-target="#carouselNovidades" data-bs-slide="next">
        <span class="carousel-control-next-icon" aria-hidden="true"></span>
        <span class="visually-hidden">Next</span>
      </button>
    </div>

    <br>

    <div class="d-grid gap-2 d-md-flex justify-content-md-end">
      <button type="button" id="btnAdicionar1" class="btn btn-primary">
        Adicionar  sua lista
      </button>
    </div>
  </div>
  <!-- fim SLIDE 1 -->
  <!-- SLIDE 2 -->
  <div class="container mt-5 mb-5">
    <div id="carouselDois" class="carousel slide">
      <div class="carousel-indicators">
        <button type="button" data-bs-target="#carouselDois" data-bs-slide-to="0" class="active"
          aria-label="Slide 1"></button>
        <button type="button" data-bs-target="#carouselDois" data-bs-slide-to="1" aria-label="Slide 2"></button>
        <button type="button" data-bs-target="#carouselDois" data-bs-slide-to="2" aria-label="Slide 3"></button>
      </div>
      <div class="carousel-inner">
        <div class="carousel-item active" data-livro-id="5">
          <img src="{{ url_for('static', filename='images/slide4.jpg') }}" class="d-block w-100" alt="Imagem">
        </div>
        <div class="carousel-item" data-livro-id="5">
          <img src="{{ url_for('static', filename='images/slide5.jpg') }}" class="d-block w-100" alt="Imagem">
        </div>
        <div class="carousel-item" data-livro-id="5">
          <img src="{{ url_for('static', filename='images/slide6.jpg') }}" class="d-block w-100" alt="Imagem">
        </div>
      </div>
      <button class="carousel-control-prev px-3" type="button" data-bs-target="#carouselDois" data-bs-slide="prev">
        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
        <span class="visually-hidden">Previous</span>
      </button>
      <button class="carousel-control-next px-3" type="button" data-bs-target="#carouselDois" data-bs-slide="next">
        <span class="carousel-control-next-icon" aria-hidden="true"></span>
        <span class="visually-hidden">Next</span>
      </button>
    </div>

    <div class="d-grid gap-2 d-md-flex justify-content-md-end mt-4">
      <button type="button" id="btnAdicionar2" class="btn btn-primary">
        Adicionar a sua lista
      </button>
    </div>
  </div>

  <!-- fim SLIDE 2 -->
  <!-- SLIDE 3 -->
  <div class="container mt-5 mb-5">
    <h3 class="mb-0">游댠游댠Mais Resenhados:</h3>
    <hr class="border border-2 border-success opacity-75 mt-1" />

    <div id="carouselResenhados" class="carousel slide">
      <div class="carousel-indicators">
        <button type="button" data-bs-target="#carouselResenhados" data-bs-slide-to="0" class="active"
          aria-label="Slide 1"></button>
        <button type="button" data-bs-target="#carouselResenhados" data-bs-slide-to="1" aria-label="Slide 2"></button>
        <button type="button" data-bs-target="#carouselResenhados" data-bs-slide-to="2" aria-label="Slide 3"></button>
        <button type="button" data-bs-target="#carouselResenhados" data-bs-slide-to="3" aria-label="Slide 4"></button>
      </div>

      <div class="carousel-inner rounded-3">
        <div class="carousel-item active" data-livro-id="1">
          <img src="{{ url_for('static', filename='images/slide7.jpg') }}" class="d-block w-100" alt="Livro 4">
        </div>
        <div class="carousel-item" data-livro-id="2">
          <img src="{{ url_for('static', filename='images/slide8.jpg') }}" class="d-block w-100" alt="Livro 5">
        </div>
        <div class="carousel-item" data-livro-id="3">
          <img src="{{ url_for('static', filename='images/slide9.jpg') }}" class="d-block w-100" alt="Livro 6">
        </div>
        <div class="carousel-item" data-livro-id="4">
          <img src="{{ url_for('static', filename='images/slide10.jpg') }}" class="d-block w-100" alt="Livro 3">
        </div>
      </div>

      <button class="carousel-control-prev" type="button" data-bs-target="#carouselResenhados" data-bs-slide="prev">
        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
        <span class="visually-hidden">Anterior</span>
      </button>
      <button class="carousel-control-next" type="button" data-bs-target="#carouselResenhados" data-bs-slide="next">
        <span class="carousel-control-next-icon" aria-hidden="true"></span>
        <span class="visually-hidden">Pr칩ximo</span>
      </button>
    </div>

    <div class="d-grid gap-2 d-md-flex justify-content-md-end mt-3 mb-5">
      <button id="btnAdicionar3" class="btn btn-primary">Adicionar  estante</button>
    </div>
  </div>

  <!-- fim SLIDE 3 -->

  <div class="container mt-5 mb-5">
    <h3 class="mb-0">游댠BookOpni칫es游댠:</h3>
    <hr class="border border-2 border-success opacity-75 mt-1" />
  </div>

  <div class="container mt-5">
    <div class="row g-4">
      <div class="col-md-6">
        <div class="card">
          <div class="card-header">Qual a melhor trope liter치ria 游?</div>
          <div class="card-body">
            <p>Conte칰do da enquete aqui...</p>
            <button class="btn btn-success btn-sm mt-3" onclick="mostrarResultado('res1')">Ver resultado</button>
            <div id="res1" class="resultados" style="display:none;">Resultados...</div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="mb-3"></div>

  <footer class="footer bg-success text-white text-center">
    <div class="container">
      <span>춸 2025 Laura & Maria</span>
      <div class="mt-2">
        <a href="#" class="text-white me-3"><i class="fab fa-facebook"></i></a>
        <a href="#" class="text-white me-3"><i class="fab fa-instagram"></i></a>
        <a href="#" class="text-white"><i class="fab fa-twitter"></i></a>
      </div>
    </div>
  </footer>

  <div class="toast-container position-fixed bottom-0 end-0 p-3">

    <div id="toastSucessoGeral" class="toast" role="alert" aria-live="assertive" aria-atomic="true">
      <div class="toast-header">
        <strong class="me-auto">Skoob</strong>
        <small>agora</small>
        <button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button>
      </div>
      <div class="toast-body">Adicionado ao Quero Ler com sucesso!</div>
    </div>

    <div id="toastErroGlobal" class="toast bg-danger text-white" role="alert" aria-live="assertive" aria-atomic="true">
      <div class="toast-header bg-danger text-white">
        <strong class="me-auto">Skoob</strong>
        <small>agora</small>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="toast" aria-label="Close"></button>
      </div>
      <div class="toast-body">
        Este livro j치 est치 na sua estante !
      </div>
    </div>
  </div>

  <script>
    // --- FUN칂츾O 칔NICA PARA ADICIONAR LIVROS VIA AJAX ---
    function configurarAdicaoLivro(btnId, carouselId) {
      const btn = document.getElementById(btnId);
      const carousel = document.getElementById(carouselId);

      // Verifica칞칚o de seguran칞a (se o bot칚o ou carrossel n칚o existirem, para o c칩digo)
      if (!btn || !carousel) return;

      btn.addEventListener("click", () => {
        // Encontra o slide ativo dentro deste carrossel espec칤fico
        const ativo = carousel.querySelector(".carousel-item.active");

        if (!ativo) {
          console.error("Nenhum slide ativo encontrado no carrossel " + carouselId);
          return;
        }

        const livroId = ativo.dataset.livroId;

        if (!livroId) {
          alert("ERRO: O slide atual n칚o tem um ID de livro (data-livro-id).");
          return;
        }

        // Chama a rota AJAX
        fetch(`/livros/add_ajax/${livroId}`)
          .then(response => response.json())
          .then(data => {
            if (data.ok) {
              // Mostra Toast de Sucesso
              const toastEl = document.getElementById("toastSucessoGeral");
              const toast = new bootstrap.Toast(toastEl);
              toast.show();
            } else {
              // Mostra Toast de Erro
              const toastErroEl = document.getElementById("toastErroGlobal");
              const toastErro = new bootstrap.Toast(toastErroEl);
              toastErro.show();
            }
          })
          .catch(err => {
            console.error(err);
            alert("Erro de conex칚o ao tentar adicionar o livro.");
          });
      });
    }

    // --- ATIVA칂츾O DAS 3 SE칂칏ES ---
    // 1. Se칞칚o Novidades
    configurarAdicaoLivro("btnAdicionar1", "carouselNovidades");

    // 2. Se칞칚o Novidades Parte 2
    configurarAdicaoLivro("btnAdicionar2", "carouselDois");

    // 3. Se칞칚o Mais Resenhados
    configurarAdicaoLivro("btnAdicionar3", "carouselResenhados");


    // --- FUN칂칏ES DA ENQUETE ---
    function mostrarResultado(id) {
      const el = document.getElementById(id);
      if (el) el.style.display = (el.style.display === 'block') ? 'none' : 'block';
    }

    function toggleInput(inputId) {
      const input = document.getElementById(inputId);
      if (input) {
        if (input.style.display === 'block') {
          input.style.display = 'none';
        } else {
          input.style.display = 'block';
          input.focus();
        }
      }
    }
  </script>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-j1CDi7MgGQ12Z7Qab0qlWQ/Qqz24Gc6BM0thvEMVjHnfYGF0rmFCozFSxQBxwHKO"
    crossorigin="anonymous"></script>

</body>

</html>